# Diagram Component - Улучшенная структура

## Обзор

Компонент `Diagram` был полностью рефакторен для улучшения читаемости, поддержки и переиспользования кода.

## Структура файлов

```
src/app/components/UI/Diagram/
├── Diagram.tsx              # Основной компонент
├── index.ts                 # Экспорты
├── constants.ts             # Константы
├── types.ts                 # Типы TypeScript
├── utils.ts                 # Утилитные функции
├── components/              # Подкомпоненты
│   ├── AssetDistributionChart.tsx
│   ├── PortfolioSummary.tsx
│   ├── StatsSummary.tsx
│   └── TaxReport.tsx
├── hooks/                   # Кастомные хуки
│   ├── useAssetDistribution.ts
│   ├── useDialog.ts
│   ├── usePortfolioStats.ts
│   └── useTaxCalculation.ts
└── helpers/                 # Вспомогательные функции
    └── dataHelpers.ts
```

## Основные улучшения

### 1. Разделение ответственности
- Каждый компонент отвечает за свою функциональность
- Логика вынесена в кастомные хуки
- Утилитные функции изолированы

### 2. Типизация
- Строгая типизация всех интерфейсов
- Безопасные типы для всех операций
- Улучшенная IntelliSense поддержка

### 3. Производительность
- Мемоизация тяжелых вычислений с `useMemo`
- Оптимизированные пересчеты данных
- Кэширование результатов

### 4. Переиспользование
- Утилитные функции для общих операций
- Модульная архитектура
- Легкое тестирование

## Компоненты

### AssetDistributionChart
Отображает круговую диаграмму распределения активов.

### PortfolioSummary
Показывает общую сводку портфеля с балансами.

### StatsSummary
Отображает статистику по депозитам, покупкам, продажам и дивидендам.

### TaxReport
Показывает налоговую информацию и удержанные налоги.

## Хуки

### useAssetDistribution
Вычисляет распределение активов по тикерам.

### usePortfolioStats
Рассчитывает статистику портфеля.

### useTaxCalculation
Вычисляет налоговые данные и детали дивидендов.

### useDialog
Управляет состоянием диалогов.

## Утилиты

### formatCurrency
Форматирует числа в валютном формате.

### getConvertedAmount
Получает конвертированную сумму или исходную.

### areAllConverted
Проверяет, все ли элементы конвертированы.

## Использование

```tsx
import Diagram from '@/app/components/UI/Diagram';

function MyComponent() {
  return <Diagram portfolio={portfolio} />;
}
```

## Будущие улучшения

1. Добавить интерактивность к диаграммам
2. Реализовать экспорт данных
3. Добавить фильтрацию по датам
4. Создать дашборд с множественными представлениями
5. Добавить анимации и переходы
